(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-05e4b773"],{"11b7":function(t,e,o){},"206c":function(t,e,o){},"273c":function(t,e,o){"use strict";var s=o("11b7"),n=o.n(s);n.a},4711:function(t,e,o){"use strict";var s=o("7367"),n=o.n(s);n.a},5573:function(t,e,o){"use strict";var s=o("796a"),n=o.n(s);n.a},"5b7a":function(t,e,o){"use strict";var s=o("e5ad"),n=o.n(s);n.a},"5f60":function(t,e,o){"use strict";var s=o("206c"),n=o.n(s);n.a},7367:function(t,e,o){},"796a":function(t,e,o){},"85a5":function(t,e,o){"use strict";var s=o("d5e5"),n=o.n(s);n.a},"8d1a":function(t,e,o){"use strict";var s=o("c431"),n=o.n(s);n.a},9009:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"route_container",style:t.posts.length?"padding-bottom: 8.5rem;":null},[o("confirm-modal",{attrs:{text:"Delete",color:"red"},on:{confirm:t.deleteThread},model:{value:t.showConfirmModal,callback:function(e){t.showConfirmModal=e},expression:"showConfirmModal"}},[t._v(" Are you sure you want to delete this thread? "),o("br"),t._v("This "),o("b",[t._v("cannot")]),t._v(" be undone ")]),t.$store.state.thread.postNotification?o("thread-post-notification",{attrs:{post:t.$store.state.thread.postNotification},on:{close:function(e){return t.$store.commit("thread/setPostNotification",null)},goToPost:t.goToPostNotification}}):t._e(),o("header",{staticClass:"thread_header"},[o("div",{ref:"title",staticClass:"thread_header__thread_title"},[t._v(" "+t._s(t.thread)+" ")])]),o("div",{staticClass:"thread_side_bar"},[t.$store.state.thread.showRemovePostsButton?o("loading-button",{staticClass:"button--thin_text",class:{"button--disabled":!t.$store.state.thread.selectedPosts.length},attrs:{loading:t.$store.state.thread.removePostsButtonLoading,dark:!0},on:{click:t.removePosts}},[t._v(" Remove posts ("+t._s(t.$store.state.thread.selectedPosts.length)+") ")]):t._e(),t.$store.state.admin?o("menu-button",{attrs:{options:[{event:"lock_thread",value:t.$store.state.thread.locked?"Unlock thread":"Lock thread"},{event:"delete_thread",value:"Delete thread"},{event:"remove_posts",value:"Remove posts"}]},on:{lock_thread:t.setThreadLockedState,remove_posts:t.setThreadSelectState,delete_thread:function(e){t.showConfirmModal=!0}}},[o("button",{staticClass:"button button--thin_text"},[o("font-awesome-icon",{staticStyle:{"margin-right":"0.25rem"},attrs:{icon:["fa","cog"]}}),t._v(" Manage thread ")],1)]):t._e(),t.$store.state.thread.locked?t._e():o("button",{staticClass:"button button--thin_text",on:{click:t.replyThread}},[t._v(" "+t._s(t.replyThreadButton)+" ")]),o("post-scrubber",{attrs:{posts:t.$store.state.thread.totalPostsCount,value:t.$route.params.post_number||0},on:{input:t.goToPost}})],1),o("input-editor",{attrs:{show:t.editorState,replyUsername:t.replyUsername,loading:t.$store.state.thread.editor.loading},on:{mentions:t.setMentions,close:t.hideEditor,submit:t.addPost},model:{value:t.editor,callback:function(e){t.editor=e},expression:"editor"}}),t.$store.state.thread.locked?o("div",{staticClass:"locked_thread"},[o("h2",[t._v("Thread locked")]),t._v(" You can't post in this thread because it has been locked by an administrator ")]):t._e(),t.$store.state.thread.PollQuestionId?o("thread-poll",{attrs:{id:t.$store.state.thread.PollQuestionId}}):t._e(),o("div",{staticClass:"posts"},[o("scroll-load",{on:{loadNext:t.loadNextPosts,loadPrevious:t.loadPreviousPosts}},[t.posts.length?t._e():t._l(3,(function(t){return o("thread-post-placeholder",{key:"thread-post-placeholder-loading-"+t,class:{"post--last":2===t}})})),"previous"===t.$store.state.thread.loadingPosts?t._l(t.$store.state.thread.previousPostsCount,(function(t){return o("thread-post-placeholder",{key:"thread-post-placeholder-upper-"+t})})):t._e(),t._l(t.posts,(function(e,s){return o("thread-post",{key:"thread-post-"+e.id,ref:"posts",refInFor:!0,class:{"post--last":s===t.posts.length-1},attrs:{post:e,"show-reply":!t.$store.state.thread.locked,showSelect:t.$store.state.thread.showRemovePostsButton,highlight:t.highlightedPostIndex===s,allowQuote:!0},on:{reply:t.replyUser,goToPost:t.goToPost,selected:t.setSelectedPosts}})})),"next"===t.$store.state.thread.loadingPosts?t._l(t.$store.state.thread.nextPostsCount,(function(t){return o("thread-post-placeholder",{key:"thread-post-placeholder-lower-"+t})})):t._e()],2)],1),t.$store.state.thread.category?o("more-threads",{attrs:{category:t.$store.state.thread.category,threadId:t.$store.state.thread.threadId}}):t._e()],1)},n=[],i=(o("7db0"),o("c975"),o("ac1f"),o("5319"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"input_editor input_editor--float",class:{"input_editor--hidden":!t.show,"input_editor--focus-input":t.focusInput}},[o("div",{staticClass:"input_editor__overlay",class:{"input_editor__overlay--show":t.loading}},[o("loading-icon")],1),t.replyUsername?o("div",{staticClass:"input_editor__reply_username"},[t._v("Replying to "),o("strong",[t._v(t._s(t.replyUsername))])]):t._e(),o("div",{staticClass:"input_editor__close input_editor__format_button",on:{click:t.closeEditor}},[t._v("×")]),o("tab-view",{attrs:{tabs:["Editor","Preview"],"small-tabs":!0},model:{value:t.showTab,callback:function(e){t.showTab=e},expression:"showTab"}},[o("template",{slot:"Editor"},[o("input-editor-core",{attrs:{value:t.value,"right-align-emoji":!0,error:t.error},on:{input:t.emitInput,mentions:t.emitMentions,focus:function(e){return t.setFocusInput(!0)},blur:function(e){return t.setFocusInput(!1)}}})],1),o("template",{slot:"Preview"},[o("input-editor-preview",{attrs:{value:t.value,mentions:t.mentions}})],1)],2),o("div",{staticClass:"input_editor__submit_bar"},[o("button",{staticClass:"button button--thin_text",on:{click:t.submit}},[t._v("Submit")])])],1)}),a=[],r=(o("498a"),o("87e6")),l=o("b422"),c=o("c5af"),u=o("6334"),d={name:"InputEditor",props:["value","error","replyUsername","show","loading"],components:{InputEditorCore:r["a"],InputEditorPreview:l["a"],LoadingIcon:c["a"],TabView:u["a"]},data:function(){return{showTab:0,mentions:[],focusInput:!1}},methods:{submit:function(){this.value.trim().length&&this.$emit("submit")},closeEditor:function(){this.emitInput(""),this.$emit("close")},emitMentions:function(t){this.mentions=t,this.$emit("mentions",t)},emitInput:function(t){this.$emit("input",t)},setFocusInput:function(t){this.focusInput=t}},watch:{show:function(t){var e;t&&(this.showTab=0),e=this.$el.querySelector("textarea"),e&&e.focus()}}},h=d,p=(o("8d1a"),o("2877")),_=Object(p["a"])(h,i,a,!1,null,"99e4421e",null),f=_.exports,m=o("8674"),v=o("1c59"),g=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"slide-fade"}},[o("div",{staticClass:"thread_post_notification",on:{click:function(e){return t.$emit("goToPost")}}},[o("span",{staticClass:"thread_post_notification__close",on:{click:function(e){return e.stopPropagation(),t.$emit("close")}}}),o("div",{staticClass:"thread_post_notification__header_bar"},[o("span",{staticClass:"thread_post_notification__username"},[t._v(t._s(t.post.username))]),t._v(" replied · click to view ")]),o("div",{staticClass:"thread_post_notification__content"},[t._v(t._s(t._f("truncate")(t._f("stripTags")(t.post.content),150)))])])])},b=[],$={name:"ThreadPostNotification",props:["post"]},w=$,P=(o("5f60"),Object(p["a"])(w,g,b,!1,null,"4591bc4c",null)),C=P.exports,y=o("eba0"),k=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.posts-1?o("div",{staticClass:"post_scrubber"},[o("div",{staticClass:"post_scrubber__label post_scrubber__label--first",on:{click:function(e){return t.$emit("input",0)}}},[t._v("First post")]),o("div",{ref:"line",staticClass:"post_scrubber__line",on:{click:t.lineClick}}),o("div",{staticClass:"post_scrubber__dragger",class:{"post_scrubber--no_top_transition":t.dragging},style:{top:t.draggerYCoord+"px"},on:{mousedown:function(e){return e.preventDefault(),e.stopPropagation(),t.setDragging(!0)},mouseup:function(e){return e.preventDefault(),e.stopPropagation(),t.setDragging(!1)}}}),o("div",{staticClass:"post_scrubber__dragger_info",class:{"post_scrubber--no_top_transition":t.dragging},style:{top:t.draggerYCoord+"px"}},[t._v(" Post "),o("strong",[t._v(t._s(t.currentPost||0))]),t._v(" out of "+t._s(t.posts)+" ")]),o("div",{staticClass:"post_scrubber__label post_scrubber__label--last",on:{click:function(e){return t.$emit("input",t.posts-1)}}},[t._v(" Latest post ")])]):t._e()},T=[],x={name:"PostScrubber",props:["posts","value"],data:function(){return{clientY:0,dragging:!1}},computed:{draggerYCoord:function(){var t=this.getLineTop(),e=this.getLineHeight();if(!this.clientY||!t)return 0;var o=this.clientY-t;return o<0?0:o>e?e:o},currentPost:function(){var t,e=this.getLineHeight()/this.posts,o=Math.floor(this.draggerYCoord/e);return t=o===this.posts?o:o+1,t}},methods:{getLineHeight:function(){var t=this.$refs.line;if(!t)return 0;var e=t.getBoundingClientRect();return e.height},getLineTop:function(){var t=this.$refs.line;if(!t)return 0;var e=t.getBoundingClientRect();return e.top},setDragging:function(t){this.dragging=t,t||this.$emit("input",this.currentPost-1)},lineClick:function(t){this.clientY=t.clientY},setCurrentPost:function(){var t=this.getLineTop(),e=this.getLineHeight(),o=+this.value,s=e/this.posts;o+1===this.posts?this.clientY=t+e:this.clientY=t+s*o}},watch:{value:"setCurrentPost"},mounted:function(){var t=this;this.setCurrentPost(),window.addEventListener("mousemove",(function(e){t.dragging&&(t.clientY=e.clientY)})),window.addEventListener("mouseup",(function(){t.dragging&&(t.dragging=!1,t.$emit("input",t.currentPost-1))}))}},I=x,M=(o("85a5"),Object(p["a"])(I,k,T,!1,null,"f7b5bbc2",null)),S=M.exports,E=o("96cf"),N=o("8e8d"),L=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"poll"},[o("transition",{attrs:{name:"slide",mode:"out-in"}},[t.poll?o("div",{key:"poll"},[o("div",{staticClass:"poll__question"},[t._v(t._s(t.poll.question))]),"voting"!==t.view||t.poll.hasVoted?o("div",{staticClass:"poll__results_view"},[o("div",{staticClass:"poll__total_votes"},[t._v(" "+t._s(t.poll.totalVotes)+" "+t._s(t._f("pluralize")(t.poll.totalVotes,"total vote"))+" ")]),o("div",{staticClass:"poll__results"},t._l(t.poll.PollAnswers,(function(e,s){return o("div",{key:"poll-result-"+s,staticClass:"poll__result"},[o("div",[t._v(" "+t._s(e.answer)+" "),o("span",{staticClass:"poll__result__info"},[t._v(" · "+t._s(e.PollVotes.length)+" "+t._s(t._f("pluralize")(e.PollVotes.length,"vote"))+" ("+t._s(e.percent||0)+"%) ")])]),o("div",{staticClass:"poll__result__bar_outer"}),o("div",{staticClass:"poll__result__bar",style:{width:(e.percent||0)+"%"}})])})),0),t.poll.hasVoted?t._e():o("div",{staticClass:"poll__buttons"},[o("button",{staticClass:"button button--thin_text",on:{click:function(e){t.view="voting"}}},[t._v("Back")])])]):o("div",{staticClass:"poll__voting_view"},[o("div",{staticClass:"poll__answers"},t._l(t.poll.PollAnswers,(function(e,s){return o("div",{key:"poll-answer-"+s,staticClass:"poll__answer",class:{"poll__answer--selected":e===t.selected},on:{click:function(o){t.selected=e}}},[t._v(" "+t._s(e.answer)+" ")])})),0),o("div",{staticClass:"poll__buttons"},[o("loading-button",{staticClass:"button--blue",class:{"button--disabled":!t.selected},attrs:{loading:t.loading},on:{click:t.vote}},[t._v("Vote now")]),o("button",{staticClass:"button button--borderless button--thin_text",on:{click:function(e){t.view="results"}}},[t._v("View results")])],1)])]):o("div",{key:"loading",staticClass:"poll__loading"},[o("loading-icon",{attrs:{dark:!0}})],1)])],1)},O=[],R=o("c4b0"),B=o.n(R),Y={name:"ThreadPoll",props:["id"],components:{LoadingIcon:c["a"],LoadingButton:N["a"]},data:function(){return{poll:null,view:"voting",selected:null,loading:!1}},methods:{vote:function(){var t=this;if(!this.$store.state.username)return this.$store.commit("setAccountTabs",0),void this.$store.commit("setAccountModalState",!0);this.loading=!0,this.axios.post("/api/v1/poll/"+this.id,{answer:this.selected.answer}).then((function(e){t.poll=e.data,t.loading=!1,t.hasVoted=!0,t.view="results"})).catch((function(e){t.loading=!1,B()(t.$store)(e)}))}},mounted:function(){var t=this;this.axios.get("/api/v1/poll/"+this.id).then((function(e){return t.poll=e.data})).catch(B()(this.$store))}},A=Y,j=(o("273c"),Object(p["a"])(A,L,O,!1,null,"39de29c2",null)),V=j.exports,D=o("da16"),U=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"more_threads"},[o("div",{staticClass:"more_threads__header"},[t._v("More threads in category '"+t._s(t.category.name)+"'")]),t.empty?o("div",{staticClass:"more_threads__empty overlay_message"},[t._v(" No more threads to show ")]):[t._m(0),t._l(t.threads,(function(e){return o("div",{key:"thread-id-"+e.id,staticClass:"more_threads__thread",on:{click:function(o){return t.goToThread(e)}}},[o("div",{staticClass:"more_threads__name"},[t._v(t._s(e.name))]),o("div",{staticClass:"more_threads__date_created"},[t._v(t._s(t._f("formatDate")(e.createdAt)))])])}))]],2)},F=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"more_threads__thread more_threads__thread--header"},[o("div",{staticClass:"more_threads__name"},[t._v("Thread")]),o("div",{staticClass:"more_threads__date_created"},[t._v("Date created")])])}],H=(o("99af"),o("4de4"),o("fb6a"),{name:"MoreThreads",props:["category","threadId"],data:function(){return{threads:[],empty:!1}},methods:{goToThread:function(t){this.$router.push("/thread/".concat(t.slug,"/").concat(t.id))}},mounted:function(){var t=this;this.axios.get("/api/v1/category/"+this.category.value).then((function(e){var o=e.data.Threads.filter((function(e){return e.id!==t.threadId}));t.threads=o.slice(0,4),t.empty=!o.length})).catch(B()(this.$store))}}),q=H,Q=(o("5b7a"),Object(p["a"])(q,U,F,!1,null,"409f8ab9",null)),z=Q.exports,J=o("bd28"),K=o("84a2"),W=o.n(K),G={name:"Thread",components:{InputEditor:f,ScrollLoad:m["a"],ThreadPost:v["a"],ThreadPostNotification:C,ThreadPostPlaceholder:y["a"],PostScrubber:S,MenuButton:E["a"],LoadingButton:N["a"],ThreadPoll:V,ConfirmModal:D["a"],MoreThreads:z},data:function(){return{highlightedPostIndex:null,postNotification:null,showConfirmModal:!1}},computed:{thread:function(){return this.$store.state.thread.thread},posts:function(){return this.$store.getters.sortedPosts},replyUsername:function(){return this.$store.state.thread.reply.username},editor:{get:function(){return this.$store.state.thread.editor.value},set:function(t){this.$store.commit("setThreadEditorValue",t)}},editorState:function(){return this.$store.state.thread.editor.show},replyThreadButton:function(){return this.$store.state.username?"Reply to thread":"Login to reply"}},methods:{deleteThread:function(){this.$store.dispatch("deleteThread",this)},removePosts:function(){this.$store.dispatch("removePostsAsync",this)},setThreadLockedState:function(){this.$store.dispatch("setThreadLockedState",this)},setThreadSelectState:function(){this.$store.commit("setShowRemovePostsButton",!this.$store.state.thread.showRemovePostsButton)},setSelectedPosts:function(t){this.$store.commit("setSelectedPosts",t)},showEditor:function(){this.$store.commit("setThreadEditorState",!0)},hideEditor:function(){this.$store.commit("setThreadEditorState",!1),this.clearReply()},setMentions:function(t){this.$store.commit("setMentions",t)},clearReply:function(){this.$store.commit({type:"setReply",username:"",id:""})},replyThread:function(){this.$store.state.username?(this.clearReply(),this.showEditor()):(this.$store.commit("setAccountTabs",1),this.$store.commit("setAccountModalState",!0))},replyUser:function(t,e,o){this.$store.commit({type:"setReply",username:e,id:t,quote:o}),this.showEditor()},addPost:function(){this.$store.dispatch("addPostAsync",this)},loadNextPosts:function(){var t=this;this.$store.dispatch("loadPostsAsync",{vue:t,previous:!1})},loadPreviousPosts:function(){var t=this;this.$store.dispatch("loadPostsAsync",{vue:t,previous:!0})},loadInitialPosts:function(){this.$store.dispatch("loadInitialPostsAsync",this)},goToPost:function(t,e){var o=this,s=function(t){o.posts.find((function(e){return e.postNumber===t}))?o.highlightPost(t):(o.$router.replace({name:"thread-post",params:{post_number:t}}),o.loadInitialPosts())};e?this.axios.get("/api/v1/post/"+t).then((function(t){return s(t.data.postNumber)})):s(t)},scrollTo:function(t,e){var o=this;this.$nextTick((function(){for(var s=function(t){var e=o.$refs.posts[t].$el.getBoundingClientRect().top,s=o.$refs.title.getBoundingClientRect().height;return window.pageYOffset+e-s-32},n=function(t){var n=o.posts[t];window.scrollTo(0,s(t)),e&&e(t,n)},i=0;i<o.posts.length;i++)if(o.posts[i].postNumber===t){o.$refs.posts?n(i):o.$nextTick((function(){return n(i)}));break}}))},highlightPost:function(t){var e=this;this.scrollTo(t,(function(o){e.highlightedPostIndex=o,e.$router.replace({name:"thread-post",params:{post_number:t}}),e.highlightedPostIndex===o&&setTimeout((function(){return e.highlightedPostIndex=null}),3e3)}))},showPostNotification:function(t){var e=this;t.username!==this.$store.state.username&&(this.$store.commit("thread/setPostNotification",null),this.$store.commit("thread/setPostNotification",t),setTimeout((function(){e.$store.commit("thread/setPostNotification",null)}),5e3))},goToPostNotification:function(){var t=this.$store.state.thread.postNotification;this.goToPost(t.postNumber),this.$store.commit("thread/setPostNotification",null)}},watch:{"$route.params.id":"loadInitialPosts"},mounted:function(){var t=this,e=this,o=function(){if(e.$refs.posts){var t=e.$refs.posts.sort((function(t,e){return t.post.postNumber-e.post.postNumber})),o=t.find((function(t){var e=t.$el.getBoundingClientRect();return e.top>=74&&e.bottom<=window.innerHeight})),s=t.indexOf(o);if(s>-1){var n=e.posts[s].postNumber;e.$router.replace({name:"thread-post",params:{post_number:n}})}}};document.addEventListener("scroll",W()(o,20)),this.loadInitialPosts(),this.$socket.emit("join","thread/"+this.$route.params.id),this.$socket.on("new post",(function(e){t.showPostNotification(e),t.$store.dispatch("loadNewPostsSinceLoad",e)})),Object(J["a"])("thread",this.$route.params.id)},destroyed:function(){this.$socket.emit("leave","thread/"+this.$route.params.id),this.$socket.off("new post")}},X=G,Z=(o("4711"),Object(p["a"])(X,s,n,!1,null,"efda0470",null));e["default"]=Z.exports},"96cf":function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("menu-tooltip",{staticClass:"menu_button",attrs:{top:"0",width:"10rem","touch-disabled":"true"},model:{value:t.menuOpen,callback:function(e){t.menuOpen=e},expression:"menuOpen"}},[o("div",{staticClass:"menu_button__icon",attrs:{slot:"button"},on:{click:function(e){t.menuOpen=!0}},slot:"button"},[t._t("default")],2),o("template",{slot:"menu"},t._l(t.options,(function(e,s){return o("div",{key:"menu-button-option-"+e.value+"-"+s,staticClass:"menu_button__option",style:{"border-bottom":s===t.options.length-1?"none":"solid thin rgb(245, 245, 245)"},on:{click:function(o){return t.emit(e.event)}}},[t._v(" "+t._s(e.value)+" ")])})),0)],2)},n=[],i=o("6fab"),a={name:"MenuButton",props:["options"],components:{MenuTooltip:i["a"]},data:function(){return{menuOpen:!1}},methods:{emit:function(t){this.$emit(t),this.menuOpen=!1}}},r=a,l=(o("5573"),o("2877")),c=Object(l["a"])(r,s,n,!1,null,"5d9f8334",null);e["a"]=c.exports},c431:function(t,e,o){},d5e5:function(t,e,o){},da16:function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("modal-window",{attrs:{value:t.showModal},on:{input:t.setShowModal}},[o("div",{staticStyle:{"padding-top":"1rem"},attrs:{slot:"main"},slot:"main"},[t._t("default")],2),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("button",{staticClass:"button button--modal",class:t.buttonColor,on:{click:t.confirm}},[t._v(t._s(t.text||"OK"))]),o("button",{staticClass:"button button--modal",on:{click:function(e){return t.setShowModal(!1)}}},[t._v("Cancel")])])])},n=[],i=o("6307"),a={name:"ConfirmModal",props:["value","color","text"],components:{ModalWindow:i["a"]},data:function(){return{showModal:!1}},computed:{buttonColor:function(){return this.color?"button--"+this.color:""}},watch:{value:function(t){this.showModal=t}},methods:{setShowModal:function(t){this.showModal=t,this.$emit("input",t)},confirm:function(){this.$emit("confirm"),this.setShowModal(!1)}},mounted:function(){this.setShowModal(this.value)}},r=a,l=o("2877"),c=Object(l["a"])(r,s,n,!1,null,null,null);e["a"]=c.exports},e5ad:function(t,e,o){}}]);
//# sourceMappingURL=chunk-05e4b773.2b1d892e.js.map